<!DOCTYPE html>

<html lang="en">
    <head>
    <meta charset="utf-8">
    <!--
        hexo-theme-suka © SukkaW
        GitHub: https://github.com/SukkaW/hexo-theme-suka
    -->

    <!-- ### Resource Hint ### -->

    <!-- ## DNS Prefetch ## -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

<!-- busuanzi -->

    <link rel="dns-prefetch" href="//busuanzi.ibruce.info">


<!-- comment -->



    <link rel="dns-prefetch" href="//api.github.com">
    <link rel="dns-prefetch" href="//cors-anywhere.herokuapp.com">





<!-- analytics -->







    <!-- ## Preload ## -->
    
    <!-- Busuanzi -->
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" as="script">







    <!-- ### Meta & Title & Info ### -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    <meta name="renderer" content="webkit">

    <!-- Title -->
    <title>一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站 | 南猫</title>

    <!-- Favicons -->
    <link rel="icon" type="image&#x2F;ico" href="/img/suka-favicon.ico">

    <!-- ### Import File ### -->
    <link rel="stylesheet" href="/lib/spectre/spectre.min.css"><style>
    body {
        background-color: #f8f9fa;
    }

    a, a:visited {
        color: #0070ff;
    }

    a:active, a:focus, a:hover {
        color: #0070ff;
        opacity: .75;
    }

    #post-content a,
    #post-content a:hover,
    #post-content a:focus,
    #post-content a:visited {
        color: #005eb9;
        opacity: 1;
    }

    

    .post-entry .card-body a {
        color: #0070ff;
    }

    .avatar {
        background: #444;
    }

    .navbar-link,
    .navbar-link:visited,
    .timeline .timeline-item .timeline-icon.icon-lg {
        color: #0070ff;
    }

    .navbar-link:hover {
        color: #0070ff;
        opacity: .8;
    }

    #search-input .btn,
    #disqus_click_btn,
    #disqus-switch-to-direct,
    #disqus-loadmore-button {
        background: #727e96;
        border-color: #727e96;
        color: #fff;
    }

    #post-toc a.post-toc-link,
    #post-toc a.post-toc-link:visited,
    .share-menu.menu .menu-item>a {
        color: #727e96;
    }

    .share-menu.menu .menu-item>a:hover,
    .share-menu.menu .menu-item>a:focus,
    .share-menu.menu .menu-item>a:visited {
        color: #50596c;
        background: #f8f9fa;
        opacity: .85;
    }
</style><link rel="stylesheet" href="/css/style.min.css">








    <!-- Prettify Theme -->
    
    <link rel="preload" href="/css/highlight/github.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript>





<script>
/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
!function(t){"use strict";t.loadCSS||(t.loadCSS=function(){});var e=loadCSS.relpreload={};if(e.support=function(){var e;try{e=t.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),e.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},e.poly=function(){if(!e.support())for(var a=t.document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=a[n];"preload"!==o.rel||"style"!==o.getAttribute("as")||o.getAttribute("data-loadcss")||(o.setAttribute("data-loadcss",!0),e.bindMediaToggle(o))}},!e.support()){e.poly();var a=t.setInterval(e.poly,500);t.addEventListener?t.addEventListener("load",function(){e.poly(),t.clearInterval(a)}):t.attachEvent&&t.attachEvent("onload",function(){e.poly(),t.clearInterval(a)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:t.loadCSS=loadCSS}("undefined"!=typeof global?global:this);
</script>

    <!-- ### Site Verification ### -->
    


    <meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="南猫"><meta name="msapplication-starturl" content="https://southcat.net"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="南猫"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- ### The Open Graph & Twitter Card Protocol ### -->
    <meta property="og:title" content="一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站 | 南猫"><meta property="og:site_name" content="南猫"><meta property="og:type" content="article"><meta property="og:url" content="https://southcat.net/2414/"><meta property="og:locale" content="en"><meta name="description" content="说明：CQ-picfinder-robot是一个由綺凜博主使用Nodejs编写的酷Q机器人插件，集成多个优秀的项目，使其用于搜图、搜番、搜本子，并夹带了许多娱乐向功能；原理就是利用SauceNAO、WhatAnime、Ascii2d搜索出自Pixiv、Twitter、Danbooru等20多个站点的插画、本子、动漫。你只需要一张图片，就可以精准定位其图片、本子、动漫的出处，使用方法也是很简单的，不 - John Doe - 南猫"><meta name="keywords" content="博客,个人记录,Jazz,,南猫,wordpress博客,技术博客,个人生活,学生博客,南方的猫"><meta property="og:image" content="https://www.southcat.net/usr/picture/cqprqq.png"><meta property="article:published_time" content="2019-12-18T14:37:28.000Z"><meta property="article:modified_time" content="2020-04-24T11:46:02.133Z"><meta property="og:updated_time" content="2020-04-24T11:46:02.133Z"><meta property="article:author" content="John Doe"><meta property="article:tag" content="博客,个人记录,Jazz,,南猫,wordpress博客,技术博客,个人生活,学生博客,南方的猫"><meta name="twitter:card" content="summary">

    

    <!-- ### Canonical link ### -->
    <link rel="canonical" href="https://southcat.net/2414/">

    <meta name="generator" content="Hexo 4.2.0">

    <!-- ### Analytics ### -->
    







    <!-- ### Structured Data ### -->
    



<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "url": "https://southcat.net/2414/",
    "@type": "BlogPosting",
    "logo": "https://southcat.net/img/suka-favicon.ico",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://southcat.net/2414/"
    },
    "headline": "一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站 | 南猫",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://southcat.net/img/suka-favicon.ico"
    },
    
    "datePublished": "2019-12-18T14:37:28.000Z",
    "dateModified": "2020-04-24T11:46:02.133Z",
    "author": {
        "@type": "Person",
        "name": "John Doe",
        "image": {
            "@type": "ImageObject",
            "url": "https://southcat.net/img/default_avatar.png"
        },
        "description": "Hey，你好"
    },
    "publisher": {
        "@type": "Organization",
        "name": "南猫",
        "logo": {
            "@type": "ImageObject",
            "url": "https://southcat.net/img/suka-favicon.ico"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://southcat.net/search.html?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "博客,个人记录,Jazz,,南猫,wordpress博客,技术博客,个人生活,学生博客,南方的猫",
    "description": "说明：CQ-picfinder-robot是一个由綺凜博主使用Nodejs编写的酷Q机器人插件，集成多个优秀的项目，使其用于搜图、搜番、搜本子，并夹带了许多娱乐向功能；原理就是利用SauceNAO、WhatAnime、Ascii2d搜索出自Pixiv、Twitter、Danbooru等20多个站点的插画、本子、动漫。你只需要一张图片，就可以精准定位其图片、本子、动漫的出处，使用方法也是很简单的，不 - John Doe - 南猫"
}
</script>



    <!-- ### Custom Head ### -->
    
</head>

    <body>
            

            <!-- ### Main content ### -->
            <!-- ## Header ##-->
<header>
    <h1 class="header-title text-center"><a href="/">南猫</a></h1>

    <p class="text-center header-slogan">
        
            
                Hey，你好
            
        
    </p>

    <nav class="navbar-section text-center">
    
        <a href="/" class="navbar-link">Home</a>
    
    
        <a href="/archives/" class="navbar-link">Archives</a>
    
    
        <a href="/search.html" class="navbar-link">Search</a>
    
    
        <a href="/link.html" class="navbar-link">Friends</a>
    
    
        <div class="dropdown dropdown-right">
    <a class="navbar-link dropdown-toggle" tabindex="0">Share</a>
    <ul class="menu share-menu">

        <!-- Share Weibo -->
        
        <li class="menu-item">
            <a href="http://service.weibo.com/share/share.php?appkey=&title=南猫&url=https://southcat.net&pic=https://southcat.net/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
        </li>
        

        <!-- Share Twitter -->
        
        <li class="menu-item">
            <a href="https://twitter.com/intent/tweet?text=南猫&url=https://southcat.net&via=John Doe" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
        </li>
        

        <!-- Share Facebook -->
        
        <li class="menu-item">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://southcat.net" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
        </li>
        

        <!-- Share Google+ -->
        
        <li class="menu-item">
            <a href="https://plus.google.com/share?url=https://southcat.net" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
        </li>
        

        <!-- Share LinkedIn -->
        
        <li class="menu-item">
            <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://southcat.net&title=一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
        </li>
        

        <!-- Share QQ -->
        
        <li class="menu-item">
            <a href="http://connect.qq.com/widget/shareqq/index.html?site=南猫&title=一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站&summary=&pics=https://southcat.net/img/suka-favicon.ico&url=https://southcat.net" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
        </li>
        

        <!-- Share Telegram -->
        
        <li class="menu-item">
            <a href="https://t.me/share/url?url=https://southcat.net&text=一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
        </li>
        

        <!-- QRCode -->
        
        <li class="menu-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAB0CAAAAABx8Un7AAABMElEQVR42u3a2w5CIQxEUf7/p/X1RGlnuFgw2byYKLJIrLTAaa8DrYGCgk6hLWnPz78GCPpF44DWot0f/dlZTMAeB7QU7QXGDJqOA3oFGk0i6wf6H2jWF/RONPuzR8HzsywDuoyqwsx93VoNgk6jctMTDZAk9OVdG+gS+vnFbOHuQTJ4nBUJdDvqBItbfGeJAbQGdReC3oC9CUYBB1qLjgSME2hhkIGWoTvxNCBBS1DngFltfsOkPZJlQLeh2SY4Chi3SJNZBrQEzaDRg0o7kEC3om6hneFqEwVai7oHHSoBqINJ0DrUvYh3ijbQe1D3Yj1K3OowC/QM6lzwqYPLoSwDegwdLbLT90CvQbOLBPXQ1HQggS6jasFfXexBa1HnIl4ldGvBAC1BKxsoKOhQewNME/HCJqm8XAAAAABJRU5ErkJggg==" alr="QRCode">
        </li>
        

    </ul>
</div>
    
    
</nav>
</header>

            
    <!-- ## Post ## -->
    <div class="post-container">
    <div id="post-card" class="card">
        
        <div class="card-item-container">
            <div class="card-inner-cell">
                <!-- # Post Header Info # -->
                <div class="card-header">
                    
    <h1 class="card-title h3 mb-2">一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站</h1>




<div class="post-header-info">
    <p class="post-header-info-left text-gray">
        <img class="author-thumb lazyload" data-src="/img/default_avatar.png" src="/img/suka-lazyload.gif" alt="John Doe's Avatar">
        <span>2019-12-18</span>
        
            <span class="suka-devide-dot"></span>
            <a class="category-link" href="/categories/cj/">cj</a>
        
        
            <!-- Busuanzi Post Views -->
<span id="busuanzi_container_page_pv" hidden>
    <span class="suka-devide-dot"></span>
    <span></span>
    <span id="busuanzi_value_page_pv"></span>
    <span>Views</span>
</span>
        
        
    </p>
    <div class="post-header-info-right">
        
            <div class="dropdown dropdown-right">
<a class="dropdown-toggle" tabindex="0">Share the post</a>
<ul class="menu share-menu">
    <!-- Share Weibo -->
    
    <li class="menu-item">
        <a href="http://service.weibo.com/share/share.php?appkey=&title=一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站&url=https://southcat.net/2414/&pic=https://southcat.net/img/suka-favicon.ico&searchPic=false&style=simple" target="_blank" rel="external noopener noreferrer nofollow">Share to Weibo</a>
    </li>
    

    <!-- Share Twitter -->
    
    <li class="menu-item">
        <a href="https://twitter.com/intent/tweet?text=一个二次元搜图、搜番、搜本子QQ机器人，支持SauceNAO、WhatAnime、Ascii2d等网站&url=https://southcat.net/2414/&via=John Doe" target="_blank" rel="external noopener noreferrer nofollow">Share to Twitter</a>
    </li>
    

    <!-- Share Facebook -->
    
    <li class="menu-item">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://southcat.net/2414/" target="_blank" rel="external noopener noreferrer nofollow">Share to Facebook</a>
    </li>
    

    <!-- Share Google+ -->
    
    <li class="menu-item">
        <a href="https://plus.google.com/share?url=https://southcat.net/2414/" target="_blank" rel="external noopener noreferrer nofollow">Share to Google+</a>
    </li>
    

    <!-- Share LinkedIn -->
    
    <li class="menu-item">
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://southcat.net/2414/&title=南猫" target="_blank" rel="external noopener noreferrer nofollow">Share to LinkedIn</a>
    </li>
    

    <!-- Share QQ -->
    
    <li class="menu-item">
        <a href="http://connect.qq.com/widget/shareqq/index.html?site=南猫&title=南猫&summary=&pics=https://southcat.net/img/suka-favicon.ico&url=https://southcat.net/2414/" target="_blank" rel="external noopener noreferrer nofollow"> Share to QQ</a>
    </li>
    

    <!-- Share Telegram -->
    
    <li class="menu-item">
        <a href="https://t.me/share/url?url=https://southcat.net/2414/&text=南猫" target="_blank" rel="external noopener noreferrer nofollow">Share to Telegram</a>
    </li>
    

    <!-- QRCode -->
    
    <li class="menu-item">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAB0CAAAAABx8Un7AAABMElEQVR42u3a2w5CIQxEUf7/p/X1RGlnuFgw2byYKLJIrLTAaa8DrYGCgk6hLWnPz78GCPpF44DWot0f/dlZTMAeB7QU7QXGDJqOA3oFGk0i6wf6H2jWF/RONPuzR8HzsywDuoyqwsx93VoNgk6jctMTDZAk9OVdG+gS+vnFbOHuQTJ4nBUJdDvqBItbfGeJAbQGdReC3oC9CUYBB1qLjgSME2hhkIGWoTvxNCBBS1DngFltfsOkPZJlQLeh2SY4Chi3SJNZBrQEzaDRg0o7kEC3om6hneFqEwVai7oHHSoBqINJ0DrUvYh3ijbQe1D3Yj1K3OowC/QM6lzwqYPLoSwDegwdLbLT90CvQbOLBPXQ1HQggS6jasFfXexBa1HnIl4ldGvBAC1BKxsoKOhQewNME/HCJqm8XAAAAABJRU5ErkJggg==" alt="QRCode">
    </li>
    

</ul>
</div>
        
    </div>
</div>
                </div>
                <div class="card-body">
                    
                        
                        
                            <div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#截图"><span class="post-toc-number">1.</span> <span class="post-toc-text">截图</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#安装"><span class="post-toc-number">2.</span> <span class="post-toc-text">安装</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用"><span class="post-toc-number">3.</span> <span class="post-toc-text">使用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#说明"><span class="post-toc-number">4.</span> <span class="post-toc-text">说明</span></a></li></ol></div>
                        
                    
                    <article id="post-content">
                        <p><strong>说明：</strong><code>CQ-picfinder-robot</code>是一个由綺凜博主使用<code>Nodejs</code>编写的<code>酷Q</code>机器人插件，集成多个优秀的项目，使其用于搜图、搜番、搜本子，并夹带了许多娱乐向功能；原理就是利用<code>SauceNAO</code>、<code>WhatAnime</code>、<code>Ascii2d</code>搜索出自<code>Pixiv</code>、<code>Twitter</code>、<code>Danbooru</code>等<code>20</code>多个站点的插画、本子、动漫。你只需要一张图片，就可以精准定位其图片、本子、动漫的出处，使用方法也是很简单的，不过貌似都是在<code>Windows</code>上使用，毕竟很方便，这里就发下在<code>Linux VPS</code>中的使用方法。</p>
<h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p><img src="https://www.southcat.net/usr/picture/cqprqq.png" alt="请输入图片描述" title="请输入图片描述"></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><strong>Github地址：</strong><a href="https://github.com/Tsuk1ko/CQ-picfinder-robot" target="_blank" rel="noopener">https://github.com/Tsuk1ko/CQ-picfinder-robot</a></p>
<p><strong>说明：</strong>该插件必须配合<code>酷Q</code>一起使用，且需要启动<code>CoolQ HTTP API</code>插件，并将配置文件<code>use_ws</code>设置为<code>true</code>，可参考：插件使用文档。</p>
<p><strong>提示：</strong>如果你的<code>VPS</code>内存过小，包括<code>512M</code>内存，建议加点虚拟内存，<code>Swap</code>一键脚本→传送门。</p>
<p><strong>1、安装CoolQ机器人</strong></p>
<pre><code>提示：想要完整的功能的，建议使用Pro；不过Pro也不是必须的，Air也可以，但Air无法发送图片，某些功能会受限，但能满足基本使用。</code></pre><p>如果你用<code>Windows</code>系统，则自行安装；<code>Linux</code>系统，则使用<code>Docker</code>安装，这里就使用带<code>CoolQ HTTP API</code>插件的<code>CoolQ Docker</code>镜像，具体步骤如下。</p>
<p>安装<code>Docker</code>：</p>
<pre><code>#CentOS 6
rpm -iUvh http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
yum update -y
yum -y install docker-io
service docker start
chkconfig docker on

#CentOS 7、Debian、Ubuntu
curl -sSL https://get.docker.com/ | sh
systemctl start docker
systemctl enable docker</code></pre><p>安装<code>CoolQ</code>：</p>
<pre><code>#安装酷Q Air图灵版
docker run --name wine-coolq -d \
-v /coolq:/home/user/coolq \
-p 9000:9000 \
-p 6700:6700 \
-e VNC_PASSWD=moerats \
richardchien/cqhttp

#安装酷Q Pro图灵版
docker run --name wine-coolq -d \
-v /coolq:/home/user/coolq \
-p 9000:9000 \
-p 6700:6700 \
-e VNC_PASSWD=moerats \
-e COOLQ_URL=https://dlsec.cqp.me/cqp-tuling \
richardchien/cqhttp</code></pre><p>参数大致说明：</p>
<pre><code>-p 将内部的Web运行端口9000映射到外部的9000，可自行修改端口。
-v 将内部酷Q和其数据文件夹/home/user/coolq映射到外部的/coolq文件夹，可自行修改路径。
-e VNC_PASSWD为VNC密码。注意该密码不能超过8个字符，默认MAX8char。</code></pre><p>再删掉默认的配置文件，不然后面可能不会生成特定的<code>QQ</code>配置文件，使用命令：</p>
<pre><code>rm -rf /coolq/app/io.github.richardchien.coolqhttpapi/config/general.ini</code></pre><p>然后就可以访问<code>http://ip:9000</code>，输入<code>VNC</code>页面密码，文中默认<code>moerats</code>，即可看到一个<code>酷Q</code>已经启动，如果是<code>Pro</code>的话，会先要你输入授权码。</p>
<p>如果打不开界面，还需要开启<code>9000</code>端口，一般出现在<code>CentOS</code>系统，开启如下：</p>
<pre><code>#CentOS 6
iptables -I INPUT -p tcp --dport 9000 -j ACCEPT
service iptables save
service iptables restart

#CentOS 7
firewall-cmd --zone=public --add-port=9000/tcp --permanent
firewall-cmd --reload</code></pre><p>有些服务器，比如阿里云，谷歌云等都还需要在面板安全组开启该端口。</p>
<p>第一次登录<code>QQ</code>账号会生成特定的<code>CoolQ HTTP API</code>配置文件，路径为<code>app/io.github.richardchien.coolqhttpapi/config</code>，然后进行如下修改：</p>
<pre><code>#注意每次更换新的QQ号登录机器人，都要进行该操作
1、根据路径找到配置文件，格式为QQ号.json
2、编辑配置文件，将use_ws后面的false改为true

#不想麻烦的，可以直接ssh客户端使用命令修改，命令如下：
sed -i &apos;s#&quot;use_ws&quot;: false#&quot;use_ws&quot;: true#g&apos; /coolq/app/io.github.richardchien.coolqhttpapi/config/*.json</code></pre><p>接下来在<code>VNC</code>页面，右键右下角悬浮球，快速重启机器人即可。</p>
<p><strong>2、安装Nodejs</strong></p>
<pre><code>#Debian/Ubuntu系统
curl -sL https://deb.nodesource.com/setup_10.x | bash -
apt install -y git nodejs 

#CentOS系统
curl -sL https://rpm.nodesource.com/setup_10.x | bash -
yum install nodejs git -y</code></pre><p><strong>3、安装CQ-picfinder-robot</strong></p>
<pre><code>#拉取项目
git clone https://github.com/Tsuk1ko/CQ-picfinder-robot.git
cd CQ-picfinder-robot
#复制配置文件
cp config.default.json config.json
#安装依赖
npm i
#安装pm2
npm install -g pm2</code></pre><p><code>config.json</code>配置文件参考如下：</p>
<pre><code>#别直接将下面配置文件复制进去，JSON是不允许注释的，仅供参考
{
    //前面这几项配置请参考https://github.com/momocow/node-cq-websocket/blob/master/docs/api/CQWebSocket.md#cqwebsocketoption
    &quot;host&quot;: &quot;127.0.0.1&quot;,
    &quot;port&quot;: 6700,
    &quot;enableAPI&quot;: true,
    &quot;enableEvent&quot;: true,
    &quot;access_token&quot;: &quot;&quot;,
    &quot;reconnection&quot;: true,
    &quot;reconnectionAttempts&quot;: 10,
    &quot;reconnectionDelay&quot;: 5000,
    //以下开始都是搜图机器人配置
    &quot;picfinder&quot;: {
        &quot;debug&quot;: false,            //调试模式，启用后会在控制台输出每次查询的返回文本
        &quot;admin&quot;: -1,               //指定管理者QQ，请务必设置
        &quot;autoAddFriend&quot;: false,    //自动同意好友申请（false则忽略，但不会拒绝）
        &quot;addFriendAnswers&quot;: [],    //根据问题回答同意好友申请（后续详解
        &quot;autoAddGroup&quot;: false,     //自动同意入群申请（false同上，但可以用命令手动允许，后续有说明）
        &quot;searchLimit&quot;: 30,         //每名用户每日搜索次数限制
        //复读机
        &quot;repeat&quot;: {
            &quot;enable&quot;: true,        //开关
            &quot;times&quot;: 3,            //当检测到某个群有这么多次相同发言后会概率参与复读
            &quot;probability&quot;: 40,     //复读概率（百分比）
            &quot;commonProb&quot;: 0.1      //日常复读概率（百分比）
        },
        //setu功能
        &quot;setu&quot;: {
            &quot;enable&quot;: false,       //是否启用
            &quot;allowPM&quot;: true,       //是否允许私聊使用
            &quot;pximgProxy&quot;: &quot;&quot;,      //设置发送setu时使用的反向代理，后续详解
            &quot;deleteTime&quot;: 30,      //发送后这么多秒自动撤回（0则不撤回，下同）
            &quot;cd&quot;: 600,             //使用冷却时间（秒），每名用户独立，0则无冷却
            &quot;limit&quot;: 30,           //每名用户每日次数限制
            &quot;whiteGroup&quot;: [],      //群组白名单（请按照json数组格式填写）
            &quot;whiteOnly&quot;: false,    //仅允许白名单群使用（与上面的私聊使用是独立的）
            &quot;whiteCd&quot;: 0,          //白名单群组的使用冷却时间
            &quot;whiteDeleteTime&quot;: 0   //白名单群组的撤回时间
        },
        //指令正则表达式
        &quot;regs&quot;: {
            //开启搜图模式
            &quot;searchModeOn&quot;: &quot;竹竹搜[图圖]&quot;,
            //关闭搜图模式
            &quot;searchModeOff&quot;: &quot;[谢謝]+竹竹&quot;,
            //签到
            &quot;sign&quot;: &quot;我(.*)签到&quot;,
            //setu
            &quot;setu&quot;: &quot;(竹竹.*[来來发發给給].*[色瑟][图圖])|(--setu)&quot;
        },
        //回复
        &quot;replys&quot;: {
            //默认回复
            &quot;default&quot;: &quot;必须要发送图片我才能帮你找噢_(:3」」\n支持批量！&quot;,
            //调试模式时
            &quot;debug&quot;: &quot;维护升级中，暂时不能使用，抱歉啦~&quot;,
            //个人搜索次数到达上限时
            &quot;personLimit&quot;: &quot;您今天搜的图太多辣！休息一下明天再来搜吧~&quot;,
            //搜索失败时
            &quot;failed&quot;: &quot;搜索失败惹 QAQ\n有可能是服务器网络爆炸，请重试一次&quot;,
            //签到相关
            &quot;sign&quot;: &quot;签到成功，送您10个赞！&quot;,
            &quot;signed&quot;: &quot;您今天已经签到过啦_(:3」∠)_&quot;,
            //开启搜图模式
            &quot;searchModeOn&quot;: &quot;了解～请发送图片吧！支持批量噢！\n如想退出搜索模式请发送“谢谢竹竹”&quot;,
            //已经开启搜图模式
            &quot;searchModeAlreadyOn&quot;: &quot;您已经在搜图模式下啦！\n如想退出搜索模式请发送“谢谢竹竹”&quot;,
            //关闭搜图模式
            &quot;searchModeOff&quot;: &quot;不用谢～&quot;,
            //已经关闭搜图模式
            &quot;searchModeAlreadyOff&quot;: &quot;にゃ～&quot;,
            //setu冷却中
            &quot;setuLimit&quot;: &quot;乖，要懂得节制噢 →_→&quot;,
            //setu请求错误
            &quot;setuError&quot;: &quot;瑟图服务器爆炸惹_(:3」∠)_&quot;,
            //其他不满足发送setu的条件
            &quot;setuReject&quot;: &quot;很抱歉，该功能暂不开放_(:3」」&quot;
        },
        //OCR（详细见“附加功能”）
        &quot;ocr&quot;: {
            &quot;use&quot;: &quot;ocr.space&quot;, //选择使用的OCR服务
            &quot;ocr.space&quot;: {
                &quot;defaultLANG&quot;: &quot;eng&quot;,
                &quot;apikey&quot;: &quot;&quot;
            },
            &quot;baidubce&quot;: {
                &quot;useApi&quot;: &quot;accurate_basic&quot;,
                &quot;apiKey&quot;: &quot;&quot;,
                &quot;secretKey&quot;: &quot;&quot;
            }
        },
        //明日方舟公开招募计算器（详细见“附加功能”）
        &quot;akhr&quot;: {
            &quot;enable&quot;: false,    //true则启用
            &quot;ocr&quot;: &quot;ocr.space&quot;  //选择使用的OCR服务
        }
    },
    //数据库配置（用于缓存搜图结果）
    &quot;mysql&quot;: {
        &quot;enable&quot;: false,       //是否开启缓存功能
        &quot;expire&quot;: 172800,      //缓存时间（秒），默认为两天（172800秒）
        &quot;host&quot;: &quot;127.0.0.1&quot;,   //数据库地址
        &quot;port&quot;: 3306,          //端口
        &quot;db&quot;: &quot;&quot;,              //数据库名
        &quot;user&quot;: &quot;&quot;,            //用户名
        &quot;password&quot;: &quot;&quot;,        //密码
        &quot;expire&quot;: 172800       //缓存时间
    },
    //Saucenao地址，一般请不要动，除非你猜到了我提供此设置的意义（
    &quot;saucenaoHost&quot;: [
        &quot;saucenao.com&quot;
    ],
    //WhatAnime的域名，同上
    &quot;whatanimeHost&quot;: [
        &quot;trace.moe&quot;
    ]
}</code></pre><p>启动及其它运行命令：</p>
<pre><code>#运行
npm run pm2start
#停止
npm run pm2stop
#重启
npm run pm2restart
#查看日志
npm run pm2log</code></pre><p>启动成功后建议查看下日志，如果显示连接成功即安装成功。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p><strong>1、日常使用</strong></p>
<pre><code>#私聊
1、直接发送图片即可
2、详见下方搜图模式说明

#群组&amp;讨论组
1、@机器人并发送图片
2、详见下方搜图模式说明(群限定)
3、特别地，在群组中可以发送符合配置中正则表达式的发言以进入搜图模式，在搜图模式中，发送的所有图片即使不@也会被搜图，此功能通常用于在手机上无法在转发图片时@的情况；另外，进入搜图模式后也请务必记得退出搜图模式！

#可以在同一条消息中包含多张图片(针对PC)，会自动批量搜索

#搜索图片时可以在消息内包含以下参数来指定搜索范围或者使用某项功能，参数之间互斥，优先级从上到下
1、--get-url：获取图片的在线链接（不会搜图）
2、--a2d：使用 ascii2d 进行搜索（优势在于可搜索局部图）
3、--pixiv：从P站中搜索
4、--danbooru：从Danbooru中搜索
5、--book：搜索本子
6、--anime：搜索番剧

#如果saucenao得到的结果相似度低于60%，会自动使用ascii2d进行搜索

#如果搜索到本子，会自动在 nhentai 中搜索并返回链接(如果有汉化本会优先返回汉化本链接)

#如果搜到番剧，会自动使用WhatAnime搜索番剧详细信息
1、AnimeDB与WhatAnime的结果可能会不一致，是正常现象，毕竟这是两个不同的搜索引擎
2、同时展示这两个搜索的目的是为了尽力得到你可能想要的识别结果</code></pre><p><strong>2、搜图模式</strong></p>
<pre><code>#搜图模式存在的意义是方便手机用户在转发图片等不方便在消息中夹带@或搜图参数的情况下指定搜索库

#在私聊时直接发送图库关键字
此时你发出来的下一张图（只有下一张，也就是一次性的）会使用指定搜索库

#在群组中发送符合配置中正则表达式的发言进入搜图模式
1、此时你发出的所有图片都会被搜图（默认使用全范围搜索）
2、发送图库关键字后，你后续发出的所有图片都会使用你指定的搜索库
3、每次使用完后请务必记得退出搜图模式啊，同理，也是发送符合配置中正则表达式的发言

#图库关键字：
1、all：默认的全范围搜索模式
2、以下与上方“日常使用”中描述的搜索参数功能相同
pixiv
danbooru
book
anime</code></pre><p><strong>3、处理好友申请</strong></p>
<pre><code>#如果在QQ中设置选择“允许任何人”，则直接通过，酷Q无法干预

#如果选择“需要验证信息”，则是否通过由autoAddFriend设置项决定

#如果选择“需要正确回答问题”，则是否通过由对方的回答决定，酷Q无法干预

#如果选择“需要回答问题并由我确认”，则在autoAddFriend为true，且addFriendAnswers数组不为空的情况下会进行判断，只有对方的回答与addFriendAnswers的设置完全一致才会同意</code></pre><p><code>autoAddFriend</code>为<code>false</code>时不会主动拒绝申请，只是忽略申请而已，<code>autoAddGroup</code>同理。</p>
<p><code>addFriendAnswers</code>配置规则：</p>
<pre><code>#请将问题的答案顺次作为addFriendAnswers数组的元素写入，例：
&quot;addFriendAnswers&quot;: [
    &quot;问题一的答案&quot;,
    &quot;问题二的答案&quot;
]</code></pre><p>目前貌似最多只可以设置两个问题，请一定要写入与问题个数相等数量的元素，多写会爆炸的。</p>
<p>如果你设置了两个问题但是只在<code>addFriendAnswers</code>数组中写了一个元素，那么只会验证第一个问题。</p>
<p><strong>4、手动同意进群申请</strong><br>当你设定了<code>picfinder.admin</code>为你自己的<code>QQ</code>后，假如<code>123456789</code>是你需要让机器人加的群，向机器人私聊发送<code>--add-group=123456789</code>，此时：</p>
<pre><code>#如果该群之前已经在机器人处于运行状态的时候邀请过机器人，那么该邀请会被直接同意

#如果之前没有邀请过，那么下一次邀请将会被同意

#以上两种操作都是一次性的</code></pre><p><strong>5、封禁用户/群组</strong><br>发送<code>--ban-u=Q</code>号或<code>--ban-g=</code>群号，该封禁功能并不是真的拉入黑名单，仅仅是忽略用户/群的发言，如果想解封请自行编辑<code>data/ban.json</code>删除对应<code>Q</code>号/群号。</p>
<p>更多配置和使用说明可以直接看下<code>Github</code>说明→传送门。</p>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><pre><code>#为什么有时候搜不想要的出结果？
需要说明的是，搜图引擎发现新图片并收录也是需要时间的，因此画师刚上传的画作一般情况下是没办法搜到的

另外，搜图时发送的图片必须是刚好完整的图片，使用以下几种情况的图片会导致大概率搜不到结果：
1、使用的是原图的局部图，即因剪裁而不完整，此时可以尝试使用ascii2d的特征搜索功能
2、图片被 马赛克/图片马赛克等 遮挡的部分面积过大
3、截图没截好，留有黑边，例如为了省事直接使用手机截屏或者电脑手动框选截图，这种情况请在搜图前4自行编辑裁去与图片无关的部分
4、清晰度过低的图片</code></pre><p>最后说下重启操作，每次重启镜像都会生成<code>general.ini</code>文件，这貌似会引起特定<code>QQ</code>配置不生效，这可以在安装<code>Docker</code>镜像的时候加入变量<code>-e COOLQ_ACCOUNT=123456</code>来解决这个问题，也可以在重启时删掉该文件，然后登录<code>VNC</code>即可。</p>
<pre><code>docker restart wine-coolq
rm -rf /coolq/app/io.github.richardchien.coolqhttpapi/config/general.ini</code></pre><hr>

                    </article>
                    


    <blockquote id="date-expire-notification" class="post-expired-notify">This article was last updated on <span id="date-expire-num"></span> days ago, and the information described in the article may have changed.</blockquote>
    <script>
    (function() {
        var dateUpdate = Date.parse("2020-04-24");
        var nowDate = new Date();
        var a = nowDate.getTime();
        var b = a - dateUpdate;
        var daysUpdateExpire = Math.floor(b/(24*3600*1000));
        if (daysUpdateExpire >= 120) {
            document.getElementById('date-expire-num').innerHTML = daysUpdateExpire;
        } else {
            document.getElementById('date-expire-notification').style.display = 'none';
        }
    })();
    </script>


<p class="post-footer-info mb-0 pt-0">Published at&nbsp;<time datetime="2019-12-18T14:37:28.000Z" itemprop="datePublished">2019-12-18</time>

    , Updated at&nbsp;<time datetime="2020-04-24T11:46:02.133Z" itemprop="dateModified">2020-04-24</time>

</p>
<p class="post-footer-info mb-0 pt-2">

<span class="post-categories-list mt-2">

<a class="post-categories-list-item" href='/categories/cj/'>cj</a>

</span>




</p>

                </div>
                <div class="post-nav px-2 bg-gray">
<ul class="pagination">
    <!-- Prev Nav -->
    
        <li class="page-item page-prev">
            <a href="/2248/" rel="prev">
                <div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">一款好用、美观的OneDrive目录列表程序：OLAINDEX</div>
            </a>
        </li>
    

    <!-- Next Nav -->
    
        <li class="page-item page-next">
            <a href="/2088/" rel="next">
                <div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div>
                <div class="page-item-subtitle">Linux VPS将本地脚本代码或文件推送到Github教程</div>
            </a>
        </li>
    
</ul>
</div>

                
            </div>
        </div>
    </div>
</div>

            <!-- ### Footer ### -->
            <footer class="text-center">
    <!-- footer copyright -->
    
        <p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span>
            <a class="footer-copyright-a" href="https://southcat.net">南猫</a>
        </p>

    <!-- footer custom text -->
    <p class="footer-text mb-0">
    
    </p>
    <!-- footer develop info -->
    <p class="footer-develop mb-0">
        
    <!-- Busuanzi User Views -->
    <span id="busuanzi_container_site_uv" hidden>
        <span></span>
        <span id="busuanzi_value_site_uv"></span>
        <span>Viewers</span>
        
            <span>|</span>
        
    </span>




        
        Powered by&nbsp;<!--
         --><a href="https://hexo.io" target="_blank" class="footer-develop-a" rel="external nofollow noopener noreferrer">Hexo</a><span class="footer-develop-divider"></span>Theme&nbsp;-&nbsp;<!--
         --><a href="https://github.com/SukkaW/hexo-theme-suka" target="_blank" class="footer-develop-a" rel="external noopener">Suka</a>
    </p>
</footer>


        <!-- ### Import File ### -->
        <!-- ### Footer JS Import ### -->

<script>

    
window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 50
};
document.getElementById('copyright-year').textContent = new Date().getFullYear();
console.log('\n %c Suka Theme (hexo-theme-suka) | © SukkaW | Verision 1.3.3 %c https://github.com/SukkaW/hexo-theme-suka \n', 'color: #fff; background: #444; padding:5px 0;', 'background: #bbb; padding:5px 0;');

</script>

<script src="/lib/vanilla-lazyload/lazyload.min.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" async></script>


<!-- Offset -->




<!-- Comment -->

    
        <!-- GitTalk -->
    


<!-- ### Custom Footer ### -->

    </body>

</html>